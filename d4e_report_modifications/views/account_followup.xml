<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <function name="write" model="ir.model.data">
        <function name="search" model="ir.model.data">
            <value
                eval="[('module', '=', 'account_followup'), ('name', '=', 'demo_followup_line1')]" />
        </function>
        <value eval="{'noupdate': False}" />
    </function>
        <record id="account_followup.demo_followup_line1" model="account_followup.followup.line" forcecreate="False">
            <field name="name">First reminder email</field>
            <field name="delay">15</field>
            <field name="company_id" ref="base.main_company"/>
            <field name="send_email">True</field>
            <field name="description">
                We still have no news of your payments regarding the invoices below,
                We would be grateful if you could contact our accounting department to trace them.


            </field>
        </record>
    <function name="write" model="ir.model.data">
        <function name="search" model="ir.model.data">
            <value
                eval="[('module', '=', 'account_followup'), ('name', '=', 'demo_followup_line1')]" />
        </function>
        <value eval="{'noupdate': True}" />
   </function>

    <template id="account_followup.report_followup_print_all">
        <t t-call="web.html_container">
            <t t-call-assets="web.assets_common" t-js="false" />
            <t t-set="company" t-value="docs.env.company"/>
            <t t-foreach="docs" t-as="partner">
                <t t-call="d4e_report_modifications.external_layout_invoice">
<!--                    <t t-set="fallback_address" t-value="partner.browse(partner.address_get(['invoice'])['invoice']) or partner"/>-->
<!--                    <t t-set="aml_ids" t-value="partner.transaction_ids.filtered(lambda tx: tx.state in ('pending', 'authorized', 'done'))"/>-->
<!--                    <t t-call-assets="account_followup.assets_followup_report" />-->
                    <div class="page">
                        <span t-raw="partner.get_followup_html()"></span>
                        <span>
                            <br></br>
                            <br></br>
                            <p>Si votre paiment a croisé le présent courrier, nous vous prions de considérer ce rappel nul et non avenu.</p>
                            <p>Sans nouvelles de votre part dans les 5 jours, nous serons dans l'obligation d'engager une procédure auprès d'un organisme de recouvrement de créances.</p>
                            <p>En vous remerciant de votre compréhension, nous vous prions d'accepter nos salutations les meilleures.</p>
                        </span>
                    </div>
                </t>
                <t t-if="partner.followup_level.join_invoices" t-foreach="partner.unpaid_invoices" t-as="o">
                    <t t-set="lang" t-value="o.user_id.lang if o.move_type in ('in_invoice', 'in_refund') else o.partner_id.lang"/>
                    <t t-call="account.report_invoice_document" t-lang="lang"/>
                </t>
            </t>
        </t>
    </template>

    <template id="account_followup.followup_filter_info_template">
        <div t-if='context.get("mail") != True' class="print_only" style='margin-bottom: 20px;'>
        <t t-if="invoice_address_id" t-set="partner_addr" t-value="invoice_address_id"></t>
        <t t-else="" t-set="partner_addr" t-value="partner"></t>
        <t t-if="context.get('snailmail_layout')" t-set="contact_widget_fields" t-value="['address', 'name']"/>
        <t t-else="" t-set="contact_widget_fields" t-value="['address', 'name', 'phone']"/>
            <div  style="width: 100%;">
                <div class="row fallback_header" style="margin-right: 0px; margin-left: 600px;">
                    <strong> <span t-field="partner.name" style="font-size: 15px; font-weight: bold; " /> </strong>
                    <span t-field="partner.street" style="font-size: 13px;"/>
                    <br></br>
                    <span t-field="partner.city" style="font-size: 13px; padding: 0px; margin: 0px;"/> <span t-field="partner.zip" style="font-size: 13px; padding: 0px"/>
                    <br></br>
                    Tel: <span t-field="partner.phone" style="font-size: 13px; padding: 0px; margin: 0px;"/>
                    <br></br>
                    <span t-field="partner.email" style="font-size: 13px; padding: 0px; margin: 0px;"/>
                    <br></br>
                    <span t-field="partner.website" style="font-size: 13px; padding: 0px; margin: 0px;"/>
                    <br></br>
                    <span t-field="partner.vat" style="font-size: 13px; padding: 0px; margin: 0px;"/>
                </div>
            </div>
<!--                <div class="row fallback_header">-->
<!--                    <div class="col-5 offset-7" style='margin-top: 15px;'>-->
<!--                        <div t-field="partner_addr.self"-->
<!--                            t-options='{"widget": "contact", "fields": contact_widget_fields, "no_marker": True}'/>-->
<!--                        <span t-field="partner_addr.vat"/>-->
<!--                    </div>-->
<!--                </div>-->
                <p style="margin-top: 35px;">
                    <t t-set="reminder_number" t-value="partner.followup_level.id"/>
                    <span t-if="reminder_number == 1">1er rappel </span><br/>
                    <span t-if="reminder_number > 1"><span t-esc="reminder_number"/>éme rappel </span><br/>
                    <strong>Date:</strong> <span t-esc="today" t-options="{'widget': 'date'}"/><br/>
                    <t t-if='partner_addr.ref'>Customer ref: <span t-field="partner_addr.ref"/></t>
                </p>
            </div>
        </template>
        <template id="main_table_header">
            <style>
                th:not(:first-child) {
                    border: 1px solid black !important;
                    text-align:center;
                    white-space:nowrap;
                }
            </style>

            <thead class="o_account_reports_header_hierarchy" >
                <t t-foreach="lines.get('columns_header')" t-as="header_line">
                    <tr>
                        <t t-foreach="header_line" t-as="cell">
                            <th t-att-class="'o_account_report_column_header ' + (cell.get('class', ''))"
                                t-att-colspan="cell.get('colspan')"
                                t-att-title="cell.get('title')"
                                t-att-data-toggle="cell.get('data-toggle')" >

                                <t t-call="{{cell.get('template', 'account_reports.cell_template')}}"/>
                            </th>
                        </t>
                    </tr>
                </t>
            </thead>
    </template>
    <record id="account_followup.action_report_followup" model="ir.actions.report">
        <field name="name">Print Follow-up Letter</field>
        <field name="model">res.partner</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">account_followup.report_followup_print_all</field>
        <field name="report_file">account_followup.report_followup_print_all</field>
        <field name="paperformat_id" ref="d4e_report_modifications.paperformat_invoice"/>
        <field name="print_report_name">'Followups'</field>
    </record>
</odoo>
